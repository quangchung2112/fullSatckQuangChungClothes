"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[380],{13809:function(t,e,i){i.d(e,{$Q:function(){return toCreateCheckoutParam},kR:function(){return displaySecondToTime},kT:function(){return isLineItemInstock},p_:function(){return pushEventAddToCart},wF:function(){return getCartLoggedOut},zX:function(){return getCartLoggedIn}});var r=i(63048),n=i(65530),a=i(27844),o=i(64809);i(84882);var s=i(62867),c=i(66476);let isLineItemInstock=t=>t.inventoryQuantity>0&&t.display&&t.productStatus===r.eM.ACTIVE,getCartLoggedIn=async()=>{let t=(0,n.T)().getCode();if(t){let e=await a.Z.fetchCart(t),i=e.lineItems.map(t=>({variantId:t.variantId,quantity:t.quantity,selected:t.selected})),r=await a.Z.putCart({code:e.code,lineItems:i,version:e.version});return(0,n.T)().removeCode(),(0,c.toastInfo)("Giỏ h\xe0ng đ\xe3 được thay đổi, vui l\xf2ng chọn lại m\xe3 khuyến m\xe3i"),r}{(0,n.T)().removeCode();let t=await a.Z.postCart({lineItems:[]});return t}},getCartLoggedOut=async()=>{let t=(0,n.T)().getCode();if(!t)return;let e=await a.Z.fetchCart(t);return e},pushEventAddToCart=(t,e,i,r)=>{var n,a;(0,s.$7)("add_to_cart",[{item_name:t.name,item_id:e.id,item_price:null===(n=o.Z.getFirstVariantPrice(e))||void 0===n?void 0:n.price,item_brand:s.mP,item_variant:e.color,quantity:i,userID:r}],((null===(a=o.Z.getFirstVariantPrice(e))||void 0===a?void 0:a.price)||0)*i)},displaySecondToTime=t=>{var e=Math.floor(t/60),i=t%60;return 0===e?i+" gi\xe2y":e+" ph\xfat "+i+" gi\xe2y"},toCreateCheckoutParam=t=>({line_items:t.lineItemsUseCase.filter(t=>t.isActiveProduct&&t.isInStock&&t.toJSON.selected&&t.toJSON.display).map(t=>{let{toJSON:{variantId:e,productId:i,quantity:r,selected:n}}=t;return{variant_id:e,product_id:i,quantity:r,selected:n}}),cart_code:t.toJSON.code,currency_code:t.toJSON.currency,total_price:t.toJSON.totalPrice,subtotal_price:t.toJSON.originalTotalPrice,total_discount:t.totalDiscount,payment_due:t.paymentDue("shipping")})},89683:function(t,e,i){var r=i(27573),n=i(23754),a=i(8190),o=i(41709);let getIconInform=(t,e)=>{switch(t){case"info":return(0,r.jsx)(a.m12,{size:24,className:"".concat(e?"":"text-yd-alert-info")});case"warning":return(0,r.jsx)(a.JE8,{size:24,className:"".concat(e?"":"text-yd-alert-warning")});case"success":return(0,r.jsx)(a.arM,{size:24,className:"".concat(e?"":"text-yd-alert-success")});case"error":return(0,r.jsx)(a.c59,{size:24,className:"".concat(e?"":"text-yd-alert-error")});default:return(0,r.jsx)(a.qVZ,{size:24,className:"".concat(e?"":"text-yd-typo-title")})}},getColorClassInform=(t,e)=>{switch(t){case"info":return e?"bg-yd-alert-info text-white":"border border-yd-alert-info";case"warning":return e?"bg-yd-alert-warning text-white":"border border-yd-alert-warning";case"success":return e?"bg-yd-alert-success text-white":"border border-yd-alert-success";case"error":return e?"bg-yd-alert-error text-white":"border border-yd-alert-error";default:return e?"bg-yd-black text-white":"border border-yd-typo-title"}};e.Z=t=>{let{type:e="default",isColor:i=!1,subtitle:a,onClickButton:s,buttonText:c}=t;return(0,r.jsxs)("div",{className:"w-full py-3 px-4 flex flex-1 gap-3 md:items-center rounded-xl ".concat(getColorClassInform(e,i)),children:[getIconInform(e,i),(0,r.jsxs)("div",{className:"flex flex-1 md:items-center justify-between gap-2",children:[(0,r.jsx)(o.Z,{className:"text-yd-body-3 md:min-w-[17.75rem] ".concat(i?"":"text-yd-typo-title"),children:a}),(0,r.jsx)(n.z,{variant:"text",size:"large",className:"!min-h-0 min-w-fit !px-0 flex-nowrap !items-start md:!items-center hover:bg-transparent ".concat(i?"!text-white hover:bg-transparent":"text-yd-alert-info-critical"),onClick:s,children:(0,r.jsx)(o.Z,{className:"text-yd-button-text-3",children:c})})]})]})}},65530:function(t,e,i){i.d(e,{T:function(){return localCart}});let localCart=()=>{let t="yody_cart_code";return{getCode:()=>localStorage.getItem(t),setCode:e=>{localStorage.setItem(t,e)},removeCode:()=>{localStorage.removeItem(t)}}}},17590:function(t,e,i){i.d(e,{A4:function(){return getCustomTrackingObject},Bk:function(){return createCart},dv:function(){return getCart},ir:function(){return validateCart},xu:function(){return updateCart}});var r=i(57826),n=i(10242);let getCart=async t=>{let e=await n.U.get("".concat(r.dk,"/api/carts/").concat(t,"?time=")+Date.now().valueOf());return e.data},createCart=async t=>{let e=await n.U.post("".concat(r.dk,"/api/carts/create-cart"),t);return e.data},updateCart=async t=>{let e=await n.U.put("".concat(r.dk,"/api/carts/update-cart"),t);return e.data},validateCart=async t=>{await n.U.post("".concat(r.dk,"/api/carts/verify-cart"),t)},getCustomTrackingObject=async t=>{let e=await n.U.get("".concat(r.LK,"/api/product/public/custom-tracking-object.json?product_ids=")+t.join(","));return e.data}},57275:function(t,e,i){i.d(e,{NK:function(){return getShortDescription},Sq:function(){return o},bG:function(){return getVoucherHomepage},lQ:function(){return sortListCoupon},oT:function(){return getVoucherInfo}});var r=i(57826),n=i(10242);let a={QUANTITY:{value:"QUANTITY",description:"Theo từng sản phẩm"},FIXED_PRICE:{value:"FIXED_PRICE",description:"Đồng gi\xe1"},ORDER_THRESHOLD:{value:"ORDER_THRESHOLD",description:"\xc1p dụng với mọi ho\xe1 đơn"},BUY_X_GET_Y:{value:"BUY_X_GET_Y",description:"Tặng qu\xe0"},DISCOUNT_CODE_QTY:{value:"DISCOUNT_CODE_QTY",description:"M\xe3 KM theo từng sản phẩm"},DISCOUNT_CODE_LINE:{value:"DISCOUNT_CODE_LINE",description:"M\xe3 KM theo đầu sản phẩm"}},o=[{label:"Tất cả",value:"all"},{label:"Sắp hết hạn",value:"expiring"}],getVoucherInfo=async t=>{let e=await n.U.post("".concat(r.dk,"/api/vouchers/get-vouchers"),t);return e.data},getShortDescription=t=>{switch(t){case a.QUANTITY.value:return a.QUANTITY.description;case a.FIXED_PRICE.value:return a.FIXED_PRICE.description;case a.ORDER_THRESHOLD.value:return a.ORDER_THRESHOLD.description;case a.BUY_X_GET_Y.value:return a.BUY_X_GET_Y.description;case a.DISCOUNT_CODE_QTY.value:return a.DISCOUNT_CODE_QTY.description;case a.DISCOUNT_CODE_LINE.value:return a.DISCOUNT_CODE_LINE.description}},sortListCoupon=t=>{let e=[...t];return e.sort((t,e)=>Number(e.valid)!==Number(t.valid)?Number(e.valid)-Number(t.valid):t.priority!==e.priority?t.priority-e.priority:t.valueType===e.valueType?e.value-t.value:t.valueType.localeCompare(e.valueType)),e},getVoucherHomepage=async()=>{let t=await n.U.post("".concat(r.dk,"/api/vouchers/homepage"));return t.data}},42868:function(t,e,i){i.d(e,{TK:function(){return getNewCart},Vc:function(){return getNewCartRequestData}});var r=i(88147);let getNewGiftRequestData=t=>{if(!t.variantId)throw Error("Chưa chọn variant");return{price_rule_id:t.priceRuleId,product_id:t.productId,variant_id:t.variantId,quantity:t.quantity}};var n=i(87341);let getNewCart=t=>{if(!t)return{version:-1,id:-1,code:"",lineItems:[],itemCount:-1,originalTotalPrice:-1,discountByLoyaltyPoint:-1,discountShippingFee:-1,discountByPromotionCampaign:-1,haveDiscountOrderThreshold:!1,totalPriceWithoutShippingFee:-1,discountByPromotionCode:-1,remainingAmount:-1,requiredFreeShippingAmount:-1,totalPriceAfterDiscountItem:-1,accumulatedPoints:-1,shippingFee:-1,totalPrice:-1,currency:"",discount:[],couponCode:"",coupon:void 0,gifts:[],errors:[],blockUsingLoyaltyPointWhenOrderHaveDiscount:!1,campaignSaleProduct:!1};let e=(0,r.Z)(t,{deep:!0});return e.lineItems&&Array.isArray(e.lineItems)||(e.lineItems=[]),e},getNewCartRequestData=t=>{let e={line_items:[]};return t&&(Array.isArray(t.lineItems)&&t.lineItems.forEach(t=>{e.line_items.push((0,n.p)(t))}),t.code&&(e.code=t.code),Array.isArray(t.gifts)&&(e.gifts=[],t.gifts.forEach(t=>{e.gifts.push(getNewGiftRequestData(t))})),t.couponCode&&(e.coupon_code=t.couponCode),e.version=t.version),e}},27844:function(t,e,i){i.d(e,{Z:function(){return CartService}});var r=i(63048),n=i(17590),a=i(42868),o=i(87341);let CartService=class CartService{static async updateCartSelectAndQuantity(t){if((t.line_items||[]).find(t=>t.selected&&(t.quantity>t.inventory_quantity||!t.display||t.product_status===r.eM.INACTIVE))){let e=await (0,n.xu)({code:t.code,line_items:t.line_items.map(t=>({...t,quantity:t.quantity>t.inventory_quantity&&t.inventory_quantity>0?t.inventory_quantity:t.quantity,selected:(!t.selected||!(t.inventory_quantity<=0)&&!!t.display&&t.product_status!==r.eM.INACTIVE)&&t.selected})),coupon_code:t.coupon_code,gifts:t.gifts.map(t=>({price_rule_id:t.price_rule_id,product_id:t.product_id,variant_id:t.variant_id,quantity:t.quantity})),version:t.version});if(e)return(0,a.TK)(e)}return(0,a.TK)(t)}static async fetchCart(t,e){let i=(0,a.TK)();try{let e=await (0,n.dv)(t);e&&(i=await this.updateCartSelectAndQuantity(e))}catch(t){throw t}return i}static async postCart(t,e){let i=(0,a.TK)();try{let e=(0,a.Vc)();t.lineItems&&t.lineItems.forEach(t=>{e.line_items.push((0,o.p)(t))});let r=await (0,n.Bk)(e);r&&(i=await this.updateCartSelectAndQuantity(r))}catch(t){throw t}return i}static async putCart(t,e){let i=(0,a.TK)();try{let e=(0,a.Vc)(t);t.apply_customer_loyalty_type&&(e.apply_customer_loyalty_type=t.apply_customer_loyalty_type),t.subtract_point&&(e.subtract_point=t.subtract_point);let r=await (0,n.xu)(e);r&&(i=(0,a.TK)(r))}catch(t){throw t}return i}static async verifyCart(t){try{let e=(0,a.Vc)();if(!t.code)throw Error("cart id isn't exited");return t.lineItems&&t.lineItems.forEach(t=>{e.line_items.push((0,o.p)(t))}),e.code=t.code,await (0,n.ir)(e),!0}catch(t){throw t}}}},64035:function(t,e,i){i.d(e,{n:function(){return CartUseCase}});var r=i(88147),n=i(63048);let CartLineItemUseCase=class CartLineItemUseCase{get toJSON(){return(0,r.Z)(this.lineItem,{deep:!0})}get isInStock(){return this.toJSON.inventoryQuantity>0}get isDiscounted(){return this.toJSON.discountedPrice>0}get isActiveProduct(){return this.toJSON.productStatus===n.eM.ACTIVE}get lowQuantityLabel(){return this.isActiveProduct?this.isInStock&&this.toJSON.display?this.toJSON.inventoryQuantity<=10?"C\xf2n lại "+this.toJSON.inventoryQuantity:"":"H\xeát hàng":"Ngừng bán"}isDisableChangeQuantity(t){return!this.isActiveProduct||!this.isInStock||!this.toJSON.display||t}isDisableSelect(t){return!this.isActiveProduct||!this.isInStock||!this.toJSON.display||t}get isDisableContent(){return!this.isActiveProduct||!this.isInStock||!this.toJSON.display}isDisableChangeVariant(t){return!this.isActiveProduct||this.toJSON.displayProductInventoryQuantity<=0||(!this.toJSON.display||!this.isInStock)&&!this.toJSON.otherVariantDisplay||t}constructor(t){this.lineItem=t}};let CartUseCase=class CartUseCase{get toJSON(){return(0,r.Z)(this.cartResponse,{deep:!0})}get lineItemsUseCase(){var t;return(null===(t=this.toJSON)||void 0===t?void 0:t.lineItems)?this.toJSON.lineItems.map(t=>new CartLineItemUseCase(t)):[]}get outOfStockOrStopSellingItems(){return this.lineItemsUseCase?this.lineItemsUseCase.filter(t=>!t.isInStock||!t.isActiveProduct||!t.toJSON.display):[]}get inStockLineItems(){return this.lineItemsUseCase?this.lineItemsUseCase.filter(t=>t.isInStock&&t.isActiveProduct&&t.toJSON.display):[]}get discountedAvailableLineItems(){return this.lineItemsUseCase?this.lineItemsUseCase.filter(t=>t.isDiscounted&&t.isInStock&&t.isActiveProduct&&t.toJSON.display):[]}get nonDiscountedAvailableLineItems(){return this.lineItemsUseCase?this.lineItemsUseCase.filter(t=>!t.isDiscounted&&t.isInStock&&t.isActiveProduct&&t.toJSON.display):[]}get selectedLineItems(){return this.lineItemsUseCase?this.lineItemsUseCase.filter(t=>t.toJSON.selected):[]}get totalSelectedInStockQuantity(){return this.lineItemsUseCase?this.lineItemsUseCase.reduce((t,e)=>t+(e.toJSON.selected?e.toJSON.quantity:0),0):0}get totalDiscount(){var t,e,i;return(null!==(t=this.toJSON.discountByLoyaltyPoint)&&void 0!==t?t:0)+(null!==(e=this.toJSON.discountByPromotionCampaign)&&void 0!==e?e:0)+(null!==(i=this.toJSON.discountByPromotionCode)&&void 0!==i?i:0)}paymentDue(t){return this.toJSON.originalTotalPrice+this.toJSON.shippingFee-this.getSavedAmount(t)}getDiscountedShippingFee(t){return"shipping"===t?this.toJSON.discountShippingFee:0}getSavedAmount(t){return this.totalDiscount+this.getDiscountedShippingFee(t)}getDeliveryFeeAfterDiscount(t){return this.toJSON.shippingFee-this.getDiscountedShippingFee(t)}get totalSelectedAvailableItem(){return this.lineItemsUseCase?this.lineItemsUseCase.reduce((t,e)=>t+(e.toJSON.selected&&e.isInStock&&e.isActiveProduct&&e.toJSON.display?1:0),0):0}get totalCartItemAvailable(){return this.nonDiscountedAvailableLineItems.length+this.discountedAvailableLineItems.length}get totalAvailableQuantity(){return this.lineItemsUseCase.reduce((t,e)=>{var i;return e.toJSON.quantity&&e.isActiveProduct&&e.isInStock&&e.toJSON.display?null!==(i=t+e.toJSON.quantity)&&void 0!==i?i:0:t},0)}constructor(t){this.cartResponse=t}}},87341:function(t,e,i){i.d(e,{p:function(){return getNewLineItemRequestData}}),i(88147);let getNewLineItemRequestData=t=>{let e={variant_id:-1,quantity:-1,selected:!1};return t&&(e.variant_id=t.variantId,e.quantity=t.quantity,e.selected=t.selected,(t.inventoryQuantity||0===t.inventoryQuantity)&&(e.inventory_quantity=t.inventoryQuantity),t.couponCode&&(e.coupon_code=t.couponCode)),e}},83938:function(t,e,i){i.d(e,{B:function(){return getNewProductColor}});let getNewProductColor=t=>{let e={id:-1,productId:-1,colorId:-1,color:"",parentColorId:-1,parentColor:"",imageId:-1,url:"",inventoryQuantity:-1,position:-1};return t&&(e.id=t.id,e.productId=t.product_id,e.colorId=t.color_id,e.color=t.color,e.parentColorId=t.parent_color_id,e.parentColor=t.parent_color,e.imageId=t.image_id,e.url=t.url,e.inventoryQuantity=-1,e.position=t.position),e}},28688:function(t,e,i){i.d(e,{Q:function(){return getNewProductImage}});let getNewProductImage=t=>{let e={id:-1,productId:-1,colorId:-1,color:"",imageId:-1,url:"",position:-1};return t&&(e.id=t.id,e.productId=t.product_id,e.colorId=t.color_id,e.color=t.color,e.imageId=t.image_id,e.url=t.url,e.position=t.position),e}},91165:function(t,e,i){i.d(e,{k:function(){return getNewProductSizeSpecification}});let getNewProductSizeSpecification=t=>{let e={id:-1,productSizeId:-1,specificationId:-1,type:"",value:"",unit:"",description:""};return t&&(e.id=t.id,e.productSizeId=t.product_size_id,e.specificationId=t.specification_id,e.type=t.type,e.value=t.value,e.unit=t.unit,e.description=t.description),e}},80699:function(t,e,i){i.d(e,{m:function(){return getNewProductSize}});var r=i(91165);let getNewProductSizeBodyMeasurement=t=>{let e={id:-1,productId:-1,sizeId:-1,size:"",weightUnit:"",weightMin:-1,weightMax:-1,heightUnit:"",heightMin:-1,heightMax:-1};return t&&(e.id=t.id,e.productId=t.product_id,e.sizeId=t.size_id,e.size=t.size,e.weightUnit=t.weight_unit,e.weightMin=t.weight_min,e.weightMax=t.weight_max,e.heightUnit=t.height_unit,e.heightMin=t.height_min,e.heightMax=t.height_max),e},getNewProductSize=t=>{let e={id:-1,productId:-1,sizeId:-1,size:"",weightUnit:"",weightMin:-1,weightMax:-1,heightUnit:"",heightMin:-1,heightMax:-1,specifications:[],bodyMeasurements:[],position:-1};return t&&(e.id=t.id,e.productId=t.product_id,e.sizeId=t.size_id,e.size=t.size,e.weightUnit=t.weight_unit,e.weightMin=t.weight_min,e.weightMax=t.weight_max,e.heightUnit=t.height_unit,e.heightMin=t.height_min,e.heightMax=t.height_max,e.position=t.position,e.specifications=[],e.bodyMeasurements=[],Array.isArray(t.specifications)&&t.specifications.forEach(t=>{e.specifications.push((0,r.k)(t))}),Array.isArray(t.body_measurements)&&t.body_measurements.forEach(t=>{e.bodyMeasurements.push(getNewProductSizeBodyMeasurement(t))})),e}},94358:function(t,e,i){i.d(e,{h:function(){return getNewProductVariant}});let getNewProductVariantPrice=t=>{let e={id:-1,price:-1,variantId:-1,currencyCode:"",currencySymbol:"",taxPercent:-1,compareAtPrice:-1,entitledMethod:""};return t&&(e.id=t.id,e.price=t.price,e.variantId=t.variant_id,e.currencyCode=t.currency_code,e.currencySymbol=t.currency_symbol,e.taxPercent=t.tax_percent,e.compareAtPrice=t.compare_at_price,e.entitledMethod=t.entitled_method),e},getNewProductVariant=t=>{let e={id:-1,name:"",colorId:-1,color:"",sizeId:-1,size:"",barcode:"",taxable:!1,saleable:!1,sku:"",status:"",productId:-1,inventoryQuantity:-1,prices:[],partnerSync:!1,display:!1};return t&&(e.id=t.id,e.name=t.name,e.colorId=t.color_id,e.color=t.color,e.sizeId=t.size_id,e.size=t.size,e.barcode=t.barcode,e.taxable=t.taxable,e.saleable=t.saleable,e.sku=t.sku,e.status=t.status,e.productId=t.product_id,e.prices=[],e.partnerSync=t.partner_sync,e.display=t.display,t.partner_sync&&(e.inventoryQuantity=t.inventory_quantity),Array.isArray(t.prices)&&t.prices.forEach(t=>{e.prices.push(getNewProductVariantPrice(t))})),e}},99033:function(t,e,i){i.d(e,{z:function(){return getNewProduct}});let getNewProductCharacteristic=t=>{let e={id:-1,productId:-1,characteristicId:-1,name:"",icon:"",description:""};return t&&(e.id=t.id,e.productId=t.product_id,e.characteristicId=t.characteristic_id,e.name=t.name,e.icon=t.icon,e.description=t.description),e};var r=i(83938);let getNewProductCrossSaleCollection=t=>{let e={id:-1,productId:-1,productCrossSaleCollectionId:-1,productCrossSaleCollectionName:""};return t&&(e.id=t.id,e.productId=t.product_id,e.productCrossSaleCollectionId=t.product_cross_sale_collection_id,e.productCrossSaleCollectionName=t.product_cross_sale_collection_name),e},getNewProductCrossSale=t=>{let e={id:-1,productId:-1,productCrossSaleId:-1,productCrossSaleName:""};return t&&(e.id=t.id,e.productId=t.product_id,e.productCrossSaleId=t.product_cross_sale_id,e.productCrossSaleName=t.product_cross_sale_name),e};var n=i(28688),a=i(80699),o=i(91165);let getNewProductTemplate=t=>{let e={id:-1,name:"",productSpecifications:[],urlImage:""};return t&&(e.id=t.id,e.name=t.name,e.urlImage=t.url_image,e.productSpecifications=[],Array.isArray(t.product_specifications)&&t.product_specifications.forEach(t=>{e.productSpecifications.push((0,o.k)(t))})),e};var s=i(94358);let getNewProductVideo=t=>{let e={id:-1,productId:-1,videoId:-1,url:""};return t&&(e.id=t.id,e.productId=t.product_id,e.videoId=t.video_id,e.url=t.url),e},getNewProduct=t=>{let e={id:-1,name:"",inventoryQuantity:-1,quantitySold:-1,topSeller:!1,descriptionLong:"",descriptionShort:"",customTrackingObject:"",status:"",categoryId:-1,category:"",goodsName:"",productType:"",brandId:-1,brand:"",gender:"",collections:[],haveProductTogetherSale:!1,crossSaleProducts:[],crossSaleCollections:[],madeInId:-1,madeIn:"",designerCode:"",designer:"",modelHeight:-1,modelWeight:-1,modelSize:"",material:"",component:"",careLabels:"",characteristics:[],sizes:[],productTemplateId:-1,productTemplate:getNewProductTemplate(),colors:[],images:[],video:getNewProductVideo(),variants:[],title:"",metaDesc:"",urlHandle:"",tags:"",indexStatus:null,state:null,sizeBodyMeasurementDescription:"",sizeSpecificationTemplateDescription:""};if(t){if(e.updatedDate=t.updated_date,e.id=t.id,e.name=t.name,e.descriptionLong=t.description_long,e.descriptionShort=t.description_short,e.status=t.status,e.categoryId=t.category_id,e.category=t.category,e.goodsName=t.goods_name,e.productType=t.product_type,e.brandId=t.brand_id,e.brand=t.brand,e.gender=t.gender,e.collections=t.collections||[],e.madeInId=t.made_in_id,e.madeIn=t.made_in,e.designerCode=t.designer_code,e.designer=t.designer,e.modelHeight=t.model_height,e.modelWeight=t.model_weight,e.modelSize=t.model_size,e.material=t.material,e.component=t.component,e.careLabels=t.care_labels,e.productTemplateId=t.product_template_id,e.productTemplate=getNewProductTemplate(t.product_template),e.video=getNewProductVideo(t.video),e.title=t.title,e.metaDesc=t.meta_desc,e.urlHandle=t.url_handle,e.tags=t.tags,e.indexStatus=t.index_status,e.state=t.state,e.sizeBodyMeasurementDescription=t.size_body_measurement_description,e.sizeSpecificationTemplateDescription=t.size_specification_template_description,e.crossSaleProducts=[],e.crossSaleCollections=[],e.characteristics=[],e.sizes=[],e.colors=[],e.images=[],e.variants=[],Array.isArray(t.cross_sale_products)&&t.cross_sale_products.forEach(t=>{e.crossSaleProducts.push(getNewProductCrossSale(t))}),Array.isArray(t.cross_sale_collections)&&t.cross_sale_collections.forEach(t=>{e.crossSaleCollections.push(getNewProductCrossSaleCollection(t))}),Array.isArray(t.characteristics)&&t.characteristics.forEach(t=>{e.characteristics.push(getNewProductCharacteristic(t))}),Array.isArray(t.images)&&t.images.forEach(t=>{e.images.push((0,n.Q)(t))}),Array.isArray(t.variants)&&t.variants.forEach(t=>{t.partner_sync&&e.variants.push((0,s.h)(t))}),Array.isArray(t.sizes)){let i=new Set;e.variants.forEach(t=>i.add(t.sizeId));let r=Array.from(i);t.sizes.forEach(t=>{r.includes(t.size_id)&&e.sizes.push((0,a.m)(t))})}if(Array.isArray(t.colors)){let i=new Set;e.variants.forEach(t=>i.add(t.colorId));let n=Array.from(i);t.colors.forEach(t=>{n.includes(t.color_id)&&e.colors.push((0,r.B)(t))})}}return e}},64809:function(t,e,i){i.d(e,{M:function(){return d},Z:function(){return u}});var r=i(63048),n=i(57826),a=i(10242),o=i(72815);let getProductDetailBySlug=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=await a.U.get("".concat(n.dk,"/api/products/").concat(t),{params:e});return i.data},getProducts=async t=>{let e=await a.U.get("".concat(n.dk,"/api/products").concat(t?"?".concat((0,o.stringify)(t)):""));return e.data};var s=i(99033),c=i(84882);let d={async fetchProductDetailBySlug(t,e){let i=(0,s.z)();try{let r=await getProductDetailBySlug(t,e);r&&(i=(0,s.z)(r))}catch(t){console.log("error",JSON.stringify(t))}return i},async fetchProducts(t){let e={items:[],metadata:{limit:-1,page:-1,total:-1}};try{let i=await getProducts({...t,status:r.eM.ACTIVE,partner_sync:!0,display:!0});i&&(e.metadata=i.metadata,i.items.forEach(t=>{e.items.push((0,s.z)(t))}))}catch(t){}return e},getFirstVariant:t=>(0,c.R6)(t.variants)?t.variants[0]:null,getFirstProductPrice(t){var e;let i=this.getFirstVariant(t);return null==i?void 0:null===(e=i.prices[0])||void 0===e?void 0:e.price},getFirstVariantPrice:t=>(0,c.R6)(null==t?void 0:t.prices)?t.prices[0]:null};var u=d},14447:function(t,e,i){i.d(e,{Z:function(){return VoucherService}});var r=i(57275),n=i(42312);let VoucherService=class VoucherService{get toJSON(){return(0,n.camelizeKeys)(this.voucherRes)}get manualGifts(){let t=this.toJSON,e=new Map;return t.lineItems.forEach(t=>{(t.gifts||[]).forEach(i=>{e.has(i.priceRuleId)?e.set(i.priceRuleId,{...e.get(i.priceRuleId),maxQuantity:e.get(i.priceRuleId).maxQuantity+Math.floor(t.quantity/i.quantityRange.greaterThanOrEqualTo)}):e.set(i.priceRuleId,{...i,maxQuantity:Math.floor(t.quantity/i.quantityRange.greaterThanOrEqualTo)})})}),(t.gifts||[]).forEach(t=>{e.set(t.priceRuleId,{...t,maxQuantity:1})}),Array.from(e.values())}get listGiftProductNoUnique(){return this.manualGifts.reduce((t,e)=>[...t,...e.products],[])}getListCouponInCart(){let t=this.toJSON,e=[];Array.isArray(t.coupons)&&e.push(...t.coupons),e=e.concat(...(t.lineItems||[]).map(t=>t.coupons));let i=new Map;e.forEach(t=>{let e=i.get(t.id);(!e||t.valid)&&i.set(t.id,t)});let n=Array.from(i.values());return(0,r.lQ)(n)}getListGiftLineItem(){let t=this.toJSON,e=new Map;return(t.lineItems||[]).forEach(t=>{(t.gifts||[]).forEach(t=>{let{priceRuleId:i}=t;e.has(i)||e.set(i,t)})}),Array.from(e.values())}getListGiftCart(){let t=this.toJSON;return(t.gifts||[]).map(t=>({...t,quantity:1}))}getListGift(){return[...this.getListGiftLineItem(),...this.getListGiftCart()]}getManualGiftByPriceRuleId(t){return this.manualGifts.find(e=>e.priceRuleId===t)}constructor(t){this.voucherRes=t}}},10380:function(t,e,i){i.d(e,{Qm:function(){return h},jD:function(){return useCart}});var r=i(27573),n=i(13809),a=i(89683),o=i(65530),s=i(57275),c=i(27844),d=i(64035),u=i(14447),l=i(1086),p=i(66476),m=i(78386),g=i(7653);let h={increase:"increase",decrease:"decrease"},useCart=()=>{let{cart:t,setCart:e,setPopUpType:i,voucher:h,giftRequest:y,isSelectedGiftManual:I,setUpdatingCart:f,setFetchingCart:v,setIsNotiOpen:C}=(0,l.x)(),_=(0,g.useMemo)(()=>t?new d.n(t):void 0,[t]),[S,N]=(0,g.useState)(!1),{status:w}=(0,m.useSession)(),x=(0,g.useMemo)(()=>{var e;let i=(null==t?void 0:null===(e=t.lineItems)||void 0===e?void 0:e.reduce((t,e)=>{let i=t;return e.couponCode&&i++,i},0))||0;return(null==t?void 0:t.couponCode)?i+1:i},[t]),handleSuccessApplyCoupon=async()=>{await (0,p.toastSuccess)("Đ\xe3 \xe1p dụng m\xe3 giảm gi\xe1"),i("none")},P=(0,g.useCallback)(async t=>{let e=t.lineItems.filter(t=>(0,n.kT)(t));if(e.length<=0)return;let i={line_items:e.map(t=>({variant_id:t.variantId,product_id:t.productId,quantity:t.quantity,selected:t.selected}))};N(!0);let r=await (0,s.oT)(i),a=new u.Z(r);return N(!1),a},[]),toggleGroupCartItem=async(i,r)=>{if(t){f(!0);try{let n=t.lineItems.map(t=>r.some(e=>e.toJSON.variantId===t.variantId)?{...t,selected:i}:{...t}),a={code:t.code,lineItems:n,couponCode:t.couponCode,gifts:y,version:t.version};!I&&a.gifts&&a.gifts.some(t=>!t.variantId)&&delete a.gifts;let o=await c.Z.putCart(a);e(o),f(!1)}catch(t){f(!1)}}},deleteGroupCartItems=async i=>{if(f(!0),!t)return;let r=Array.isArray(i)?i:[i],n=t.lineItems.filter(t=>!r.includes(t.variantId)),a={code:t.code,lineItems:n,version:t.version,couponCode:t.couponCode,gifts:y};try{a.apply_customer_loyalty_type="NONE",!I&&a.gifts&&a.gifts.some(t=>!t.variantId)&&delete a.gifts;let t=await c.Z.putCart(a);e(t),(0,p.toastSuccess)("Đ\xe3 gỡ sản phẩm khỏi giỏ h\xe0ng")}catch(t){(0,p.toastError)("Gỡ sản phẩm khỏi giỏ h\xe0ng thất bại")}finally{f(!1)}},T=(0,g.useCallback)(async()=>{try{let t;if(v(!0),"authenticated"===w?t=await (0,n.zX)():"unauthenticated"===w&&(t=await (0,n.wF)()),!t){v(!1);return}return v(!1),t}catch(t){v(!1)}},[v,w]),addNewCart=async t=>{let i=await c.Z.postCart({lineItems:[...t]});return"authenticated"!==w&&(0,o.T)().setCode(i.code),e(i),f(!1),i};return{couponAppliedQuantity:x,isVoucherLoading:S,fetchCurrentCart:T,addToCart:async i=>{try{if(f(!0),!t||-1===t.id)return addNewCart(i);let r={code:t.code,lineItems:(t.lineItems||[]).map(t=>({variantId:t.variantId,quantity:t.quantity,selected:t.selected,couponCode:t.couponCode})),couponCode:t.couponCode,version:t.version};I&&(r.gifts=y),i.forEach(t=>{let e=r.lineItems.findIndex(e=>e.variantId===t.variantId);if(-1!==e){let i={...r.lineItems[e]};r.lineItems.splice(e,1),r.lineItems.unshift({...i,quantity:i.quantity+t.quantity,selected:!0})}else r.lineItems.unshift(t),!I&&r.gifts&&r.gifts.some(t=>!t.variantId)&&delete r.gifts});let n=await c.Z.putCart(r);return e(n),f(!1),n}catch(t){throw f(!1),t}},deleteGroupCartItems,toggleGroupCartItem,toggleSelectCartItem:async(i,r)=>{if(t)try{let n={code:t.code,lineItems:t.lineItems.map(t=>t.variantId===i?{...t,selected:r}:{...t}),gifts:y,couponCode:t.couponCode,version:t.version};n.apply_customer_loyalty_type="NONE",!I&&n.gifts&&n.gifts.some(t=>!t.variantId)&&delete n.gifts;let a=await c.Z.putCart(n);e(a)}catch(t){}},addCoupon:async(i,n)=>{var o,s,d;if(!_||!t)return"";if(!_.totalSelectedInStockQuantity)return(0,p.toastInfo)("Vui l\xf2ng chọn sản phẩm cần mua trước"),"";if(!i)return"Vui l\xf2ng nhập m\xe3 giảm gi\xe1";let u=h.toJSON.coupons.find(t=>t.code===i),l=h.toJSON.lineItems.filter(t=>t.coupons.find(t=>t.code===i));if(!u&&0===l.length)return(0,p.toastSuccess)(t=>{let{closeToast:e}=t;return(0,r.jsx)(a.Z,{isColor:!0,buttonText:"Đ\xf3ng",type:"error",subtitle:"M\xe3 giảm gi\xe1 kh\xf4ng hợp lệ",onClickButton:e})}),"M\xe3 giảm gi\xe1 kh\xf4ng \xe1p dụng cho sản phẩm đ\xe3 chọn";let m=l.filter(t=>t.coupons.find(t=>!0===t.valid));if(!(null==u?void 0:u.valid)&&0===m.length)return(0,p.toastSuccess)(t=>{let{closeToast:e}=t;return(0,r.jsx)(a.Z,{isColor:!0,buttonText:"Đ\xf3ng",type:"error",subtitle:"M\xe3 giảm gi\xe1 kh\xf4ng \xe1p dụng cho sản phẩm đ\xe3 chọn",onClickButton:e})}),"M\xe3 giảm gi\xe1 kh\xf4ng hợp lệ, xin vui l\xf2ng kiểm tra lại";if(u){let r={code:t.code,lineItems:null===(o=t.lineItems)||void 0===o?void 0:o.map(t=>({...t,couponCode:""})),version:t.version,couponCode:i===t.couponCode&&"select"===n?"":i,apply_customer_loyalty_type:"NONE"},a=await c.Z.putCart(r);t.couponCode!==i&&handleSuccessApplyCoupon(),e(a)}else if(l.length>0){let r={code:t.code,lineItems:null===(s=t.lineItems)||void 0===s?void 0:s.map(t=>({...t})),version:t.version,couponCode:"",apply_customer_loyalty_type:"NONE"};if(1===t.lineItems.filter(t=>t.couponCode===i&&t.selected).length){r.lineItems=null===(d=t.lineItems)||void 0===d?void 0:d.map(t=>({...t,couponCode:t.couponCode===i&&"select"===n?"":t.couponCode}));let a=await c.Z.putCart(r);return e(a),"input"===n&&handleSuccessApplyCoupon(),""}{let e=t.lineItems.filter(t=>(!t.couponCode||t.couponCode!==i)&&t.selected);if(0===e.length)r.lineItems=r.lineItems.map(t=>({...t,couponCode:t.couponCode===i&&"select"===n?"":t.couponCode}));else{let t=e.filter(t=>!t.couponCode)[0];t?(e.filter(t=>!t.couponCode).forEach(e=>{let i=l.find(t=>e.variantId===t.variantId);i&&i.originalTotal>t.originalLinePrice&&(t=e)}),r.lineItems=r.lineItems.map(e=>({...e,couponCode:e.variantId===t.variantId?i:e.couponCode}))):r.lineItems=r.lineItems.map(t=>({...t,couponCode:t.couponCode?i:""}))}}let a=await c.Z.putCart(r);e(a),handleSuccessApplyCoupon()}return""},currency:(null==t?void 0:t.currency)?t.currency:"đ",getVoucherInCart:P,getListProductFromGifts:t=>{let e=new Map;return(t||[]).forEach(t=>{t.products.forEach(t=>{let{id:i}=t;e.has(i)||e.set(i,t)})}),Array.from(e.values()).sort((t,e)=>{let i=Math.max(...t.variants.map(t=>t.prices[0].compareAtPrice)),r=Math.max(...e.variants.map(t=>t.prices[0].compareAtPrice));if(r===i){let i=t.variants.reduce((t,e)=>t+e.inventoryQuantity,0),r=e.variants.reduce((t,e)=>t+e.inventoryQuantity,0);return r-i}return r-i})},cartUseCase:_}};e.ZP=useCart},1086:function(t,e,i){i.d(e,{x:function(){return o}});let getDefaultVoucher=()=>({line_items:[],coupons:[],gifts:[],sales_channel_name:"",suggested_discounts:[],type:""});var r=i(14447),n=i(13265),a=i(17939);let o=(0,n.Ue)()((0,a.mW)(t=>({isNotiOpen:!1,setIsNotiOpen:e=>t(t=>({isNotiOpen:e})),isSelectedGiftManual:!1,setSelectedGiftManual:e=>t(t=>({isSelectedGiftManual:e})),setCart:e=>t(()=>({cart:e})),isFetchingCart:void 0,setFetchingCart:e=>t(t=>({isFetchingCart:e})),isUpdatingCart:!1,setUpdatingCart:e=>t({isUpdatingCart:e}),popUpType:"none",setPopUpType:e=>t(t=>({popUpType:e})),dialogType:"none",setDialogType:e=>t(t=>({dialogType:e})),idVariantSelected:-1,setIdVariantSelected:e=>t(()=>({idVariantSelected:e})),coupons:[],setCoupons:e=>t(()=>({coupons:e})),voucher:new r.Z(getDefaultVoucher()),setVoucher:e=>t(()=>({voucher:e})),giftRequest:[],setGiftRequest:e=>t(()=>({giftRequest:e})),urlProductSelected:"",setUrlProductSelected:e=>t(()=>({urlProductSelected:e}))}),{name:"YODY-CartStore"}))}}]);